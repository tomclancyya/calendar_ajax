<?php
header("Content-Type: text/html; charset=UTF-8");
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSON</title>
        <script type="text/javascript" src="jquery.js"></script>
		 <script type="text/javascript" src="scripts/jquery.tablesorter.js"></script>
        <style type="text/css">
            #button
            {
               border: 0px;
               background-color: #11cff7;
               height: 22px;
            }
             #button:hover
            {
               background-color: #063b46;
               color: #fff;
            }
        </style>
  <link rel="stylesheet" href="stylesheets/gui.css" type="text/css" media="screen" title="timeframe" charset="utf-8"/>
  <link rel="stylesheet" href="stylesheets/timeframe.css" type="text/css" media="screen" title="timeframe" charset="utf-8"/>
  <script type="text/javascript">
  
  jQuery.noConflict();
  jQuery(document).ready(function() { 
 jQuery("#main_table").tablesorter();
         
    jQuery("#calendars_container").click(
		function(){ 
			json(); 
		});
	});
  

    function json()
    {
		var MIN_AMOUNT_OF_DATE_STRING = 12;
        var start, end; 

       jQuery('#start').each(function(){ // читаем значение начальной даты
            start=this.value
        });

       jQuery('#end').each(function(){ //  читаем значение конечной даты
            end=this.value
       }); 
	   
	   if ((start.length < MIN_AMOUNT_OF_DATE_STRING) || (end.length < MIN_AMOUNT_OF_DATE_STRING)) 
		return;
	   

       jQuery.getJSON('json.php', { b: [start],e : [end] }, function(obj){
		
		result = '';
		/*jQuery.each(obj, function(key, val) {
			result = result + ' ' + val;	  
		});*/
		
		jQuery(obj).each(function(key, element) {
			//result = result + ' ' + val;	  
			jQuery('#main_table').append('<tr><td> '+element[0]+' </td> <td> '+element[1]+' </td> <td> '+element[2]+' </td></tr>')
		});
		jQuery('#main_table').trigger("tableupdate");
		//jQuery('#result').attr('value',result);

        });

		 
    }

   </script>

</head>
<body>
  
    <h2 id="example_information">

    </h2>
    <ul>
     
    </ul>
    <div id="example" >
      <h4>Please select a date range below:</h4>
      <div id="calendars"></div>
      <div id="calendar_form">
        <div id="labels">
          <label for="start">Embarkation</label> and <label for="end">return</label> (<a href="#" onclick="return false;" id="reset">reset</a>):
        </div>
        <div id="fields" style="visibility:;" >
          <span>
            <input type="text" name="start" value="" id="start"/>ddd
            &ndash;
            <input type="text" name="end" value="" id="end"/>
          </span>
        </div>
      </div>
    </div>

    
   
  </div>

  <input type="text" name="result" id="result" size="50"> <br/>
  <div id="notice"></div> <br/>
  <input type="button" value="Пуск" id="button" onclick="json()">
  
	<table id="main_table" cellspacing="1" class="tablesorter">             
		<thead>
			<tr> 
				<th>Unix time</th> 
				<th>Date</th> 
				<th>Events</th> 				
			</tr> 
		</thead> 
		<tbody> 
		</tbody> 
	</table>

  <script type="text/javascript" charset="utf-8" src="scripts/prototype.js"></script>
  <script type="text/javascript" charset="utf-8" src="timeframe.js"></script>
  <script type="text/javascript" charset="utf-8">
    //<![CDATA[
      new Timeframe('calendars', { 
        format: '%d %B %Y',
        months: 3,
        startField: 'start',
        endField: 'end',
       
        resetButton: 'reset' });
    //]]>
  </script>


    
</body>
</html>
